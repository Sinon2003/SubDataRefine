SubDataRefine 工作流程图 (ASCII版)

=== 总体流程 ===

开始
  |
  v
检查项目结构 ------> 结构不完整 ------> 初始化项目结构
  |                                      |
  | 结构完整                              |
  v                                      v
加载配置文件 <-------------------------------
  |
  v
步骤1: 提取子域名
  |
  v
是否跳过httpx探活? ------> 是 ------> 跳过探活步骤 ------> 结束
  |                                                       ^
  | 否                                                    |
  v                                                       |
步骤2: httpx探活                                           |
  |                                                       |
  v                                                       |
探活是否成功? ------> 否 ------> 跳过结果处理 --------------+
  |                                                       |
  | 是                                                    |
  v                                                       |
步骤3: 结果处理 ------------------------------------------+


=== 子域名提取流程 ===

开始提取子域名
  |
  v
加载extract_domains脚本
  |
  v
脚本是否存在? ------> 否 ------> 报错并退出 ------> 结束
  |                                              ^
  | 是                                           |
  v                                              |
确保输出目录存在                                   |
  |                                              |
  v                                              |
处理domain目录下所有文件                           |
  |                                              |
  v                                              |
文件类型? ---+----> CSV ------> 处理CSV文件 ----+  |
           |                                  |  |
           +----> TXT/其他 ---> 处理文本文件 --+  |
                                              |  |
                                              v  |
                                          合并所有域名 |
                                              |  |
                                              v  |
                                          去重处理   |
                                              |  |
                                              v  |
                                      保存到指定输出文件 |
                                              |  |
                                              v  |
                                              结束  |
                                                   |
                                                   v
                                                  结束


=== httpx探活流程 ===

开始httpx探活
  |
  v
是否跳过探活? ------> 是 ------> 跳过探活 ------> 结束
  |                                           ^
  | 否                                        |
  v                                           |
获取httpx配置                                  |
  |                                           |
  v                                           |
httpx路径是否有效? ------> 否 ------> 报错并跳过探活 -+
  |                                           |
  | 是                                        |
  v                                           |
输入文件是否存在且不为空? ------> 否 ------> 报错并跳过探活 -+
  |                                           |
  | 是                                        |
  v                                           |
确保输出目录存在                                |
  |                                           |
  v                                           |
构建httpx命令                                  |
  |                                           |
  v                                           |
是否no-process模式? ---+----> 是 ------> 不捕获输出运行httpx --+
                     |                                     |
                     +----> 否 ------> 捕获输出运行httpx ----+
                                                           |
                                                           v
输出文件是否存在且不为空? ------> 是 ------> 探活成功 -----------+
  |                                                       |
  | 否                                                    |
  v                                                       |
退出码是否为0? ------> 是 ------> 警告：无有效目标 --------------+
  |                                                       |
  | 否                                                    |
  v                                                       |
探活失败 ---------------------------------------------------+
  |
  v
结束


=== 结果处理流程 ===

开始处理结果
  |
  v
是否跳过处理? ------> 是 ------> 跳过处理 ------> 结束
  |                                         ^
  | 否                                      |
  v                                         |
加载process_results脚本                      |
  |                                         |
  v                                         |
脚本是否存在? ------> 否 ------> 报错并退出 ----+
  |                                         |
  | 是                                      |
  v                                         |
结果文件是否存在? ------> 否 ------> 报错并退出 -+
  |                                         |
  | 是                                      |
  v                                         |
处理探活结果                                  |
  |                                         |
  v                                         |
解析探活数据                                  |
  |                                         |
  v                                         |
提取URL、状态码、标题                          |
  |                                         |
  v                                         |
输出为CSV格式 ------------------------------+


=== 数据流图 ===

domain/*.txt,*.csv ---> extract_domains.py ---> result/domains.txt ---> httpx工具 ---> temp/result.txt ---> process_results.py ---> result/result_processed.csv
       |                      ^                      ^                                                              ^
       |                      |                      |                                                              |
       v                      |                      |                                                              |
config/config.ini ------------+----------------------+--------------------------------------------------------------+


=== 文件依赖关系 ===

SubDataRefine.py
  |
  +----> utils/logging_utils.py
  |        |
  |        +----> logging模块
  |
  +----> utils/file_utils.py
  |        |
  |        +----> os模块
  |        |
  |        +----> pathlib.Path
  |
  +----> utils/config_utils.py
  |        |
  |        +----> configparser模块
  |
  +----> utils/httpx_utils.py
  |        |
  |        +----> subprocess模块
  |
  +----> script/extract_domains.py
  |        |
  |        +----> urllib.parse模块
  |
  +----> script/process_results.py
           |
           +----> re模块